<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CVE on seteuid0's blog</title><link>/tags/cve/</link><description>Recent content in CVE on seteuid0's blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>This is a customized copyright.</copyright><lastBuildDate>Mon, 02 Feb 2015 15:27:48 +0000</lastBuildDate><atom:link href="/tags/cve/index.xml" rel="self" type="application/rss+xml"/><item><title>[zz]CVE-IDs have a new format</title><link>/posts/cve-ids_have_a_new_format/</link><pubDate>Mon, 02 Feb 2015 15:27:48 +0000</pubDate><guid>/posts/cve-ids_have_a_new_format/</guid><description>之前的CVE命名规则已经无法满足现状了，已经没有什么能够阻挡漏洞挖掘的大军了。
First CVE-IDs Issued in New Numbering Format Now Available
January 13, 2015 | Share this article
The first ever CVE-ID numbers issued in the new CVE-ID numbering format were posted on January 13, 2015 for vulnerabilities disclosed in 2014: CVE-2014-10001 with 5 digits andCVE-2014-100001 with 6 digits.
The format of CVE-ID numbers was changed a year ago this month in January 2014 so that the CVE project can track 10,000 or more vulnerabilities for a given calendar year.</description></item><item><title>CVE-2013-1959内核漏洞原理与本地提权利用代码实现分析</title><link>/posts/cve-2013-1959%e5%86%85%e6%a0%b8%e6%bc%8f%e6%b4%9e%e5%8e%9f%e7%90%86%e4%b8%8e%e6%9c%ac%e5%9c%b0%e6%8f%90%e6%9d%83%e5%88%a9%e7%94%a8%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e5%88%86%e6%9e%90/</link><pubDate>Thu, 17 Apr 2014 11:58:21 +0000</pubDate><guid>/posts/cve-2013-1959%e5%86%85%e6%a0%b8%e6%bc%8f%e6%b4%9e%e5%8e%9f%e7%90%86%e4%b8%8e%e6%9c%ac%e5%9c%b0%e6%8f%90%e6%9d%83%e5%88%a9%e7%94%a8%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e5%88%86%e6%9e%90/</guid><description>关键字：CVE-2013-1959，cve，kernel vulnerability，内核漏洞，POC，利用代码，本地提权，exploit， analysis,user namespace,capabilities 2013年4月28日，Andy Lutomirski在oss-security披露了该cve的细节。CVE-2013-1959是当前内核稳定版本安全补丁修复所对应的一个CVE。这个CVE的原因是在user namespace中，/proc/uid_map存多个不正确的权限检查。如果启用相关的配置，Linux 3.8和很多3.9rcs将受到影响。利用者可以获取root权限。 修复这个CVE对应的有3个patch，以下先大致介绍这三个Patch所修改的内容。 Patch1：Add file_ns_capable() helper function for open-time capability checking``` From 935d8aabd4331f47a89c3e1daa5779d23cf244ee Mon Sep 17 00:00:00 2001 From: Linus Torvalds torvalds@linux-foundation.org Date: Sun, 14 Apr 2013 10:06:31 -0700 Subject: [PATCH] Add file_ns_capable() helper function for open-time capability checking
Nothing is using it yet, but this will allow us to delay the open-time checks to use time, without breaking the normal UNIX permission semantics where permissions are determined by the opener (and the file descriptor can then be passed to a different process, or the process can drop capabilities).</description></item><item><title>内核CVE-2014-0038漏洞原理与本地提权利用代码实现分析</title><link>/posts/%e5%86%85%e6%a0%b8cve-2014-0038%e6%bc%8f%e6%b4%9e%e5%8e%9f%e7%90%86%e4%b8%8e%e6%9c%ac%e5%9c%b0%e6%8f%90%e6%9d%83%e5%88%a9%e7%94%a8%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e5%88%86%e6%9e%90/</link><pubDate>Tue, 25 Mar 2014 17:30:02 +0000</pubDate><guid>/posts/%e5%86%85%e6%a0%b8cve-2014-0038%e6%bc%8f%e6%b4%9e%e5%8e%9f%e7%90%86%e4%b8%8e%e6%9c%ac%e5%9c%b0%e6%8f%90%e6%9d%83%e5%88%a9%e7%94%a8%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e5%88%86%e6%9e%90/</guid><description>关键字：CVE-2014-0038，内核漏洞，POC，利用代码，本地提权，提权，exploit，cve analysis, privilege escalation, cve, kernel vulnerability
简介 2014年1月31号时，solar在oss-sec邮件列表里公布了该CVE（cve-2014-0038）。这个CVE涉及到X32 ABI。X32 ABI在内核linux3.4中被合并进来，但RHEL/fedora等发行版并没有开启该编译选项，因此未受该CVE影响。Ubuntu系统在近期的版本中开启了该选项，因此收该CVE影响。X32 ABI就是在64位环境中使用32位地址，效率有所提升，相关信息请参照参考资料或google。
漏洞原理 先看该CVE对应的patch``` diff &amp;ndash;git a/net/compat.c b/net/compat.c index dd32e34..f50161f 100644 &amp;mdash; a/net/compat.c +++ b/net/compat.c @@ -780,21 +780,16 @@ asmlinkage long compat_sys_recvmmsg(int fd, struct compat_mmsghdr __user *mmsg, if (flags &amp;amp; MSG_CMSG_COMPAT) return -EINVAL;
if (COMPAT_USE_64BIT_TIME)
return \_\_sys\_recvmmsg(fd, (struct mmsghdr \_\_user \*)mmsg, vlen, flags | MSG\_CMSG\_COMPAT, (struct timespec \*) timeout); if (timeout == NULL) return __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen, flags | MSG_CMSG_COMPAT, NULL);</description></item><item><title>cvechecker实现原理分析</title><link>/posts/cvechecker%e5%ae%9e%e7%8e%b0%e5%88%86%e6%9e%90/</link><pubDate>Thu, 27 Feb 2014 09:00:20 +0000</pubDate><guid>/posts/cvechecker%e5%ae%9e%e7%8e%b0%e5%88%86%e6%9e%90/</guid><description>cvechecker是由Sven Vermeulen编写的可以用来扫描检查系统软件cve情况的软件，在SF上的下载量非常高。自己在fedora上使用了下，对比yum的信息发现存在比较严重的漏报和误报，抽空分析了下其实现方式，总结如下 。 使用过cvechecker的用户都会猜测使用的是nist的cve(Common Vulnerabilities and Exposures)[1]信息获取软件的cve列表，但是怎么和系统上的软件联系在一起呢？ 各个发行版都有自己的软件包管理系统，如redhat系列的rpm、yum。redhat、fedora负责维护rhel和fedora上各个软件包的cve信息，当执行软件包升级时，使用新的软件包替换存在cve的软件包。基于deb包的ubuntu和debian类似。因此，在特定的发行版中，只需要通过包管理器便可知道软件包的版本号，再辅以发行版提供的漏洞信息或者直接使用类似yum update的方式升级便可知道当前版本的CVE信息。 cvechecker是怎么做的呢？Sven没有依赖于包版本管理器，而是直接通过查找软件包的版本号，然后构造CPE（Common Platform Enumeration）[2]信息，通过在cve数据库中查找给CPE信息来提取CVE信息。 每个软件包都包含了众多的软件，如ls和cat都属于coreutils,那么如何从系统软件列表差找到软件包列表及版本号便是Sven方法的关键所在。通过查看代码发现，Sven自己维护了一个软件包和各个命令的映射关系表。（https://raw.github.com/sjvermeu/cvechecker/master/versions.dat）内容类似与：
,perlivp,1,perlivp$,# perlivp v([0-9][0-9]*(\.[0-9]+)+),a,perl,perl,\1,,, ,libvorbis.so,1,libvorbis.so.*,Xiph.Org libVorbis ([0-9][0-9]*(\.[0-9]+)+),a,xiph,libvorbis,\1,,,
看过cvechecker帮助文档的用户都知道，用户自己也可以定义添加这种映射表，而默认的映射表是由Sven自己维护的，默认只有650条，因此这里就是漏报的一处主要原因。 这个隐射表解决了从命令到软件包的映射，但怎么获取软件包的版本号呢？继续看代码：
/** * Here is where the various version extraction methods are supported. * We currently still only support a single method (1, which is the * &amp;ldquo;strings -n 3 &amp;rdquo; command execution) but now we can see if we can * support additional methods as well. */ if (filetype == 1) { char buffer[BUFFERSIZE]; int ret; zero_string(buffer, BUFFERSIZE); ret = strings_extract_version(ws, &amp;amp;preg, pmatch, &amp;amp;cpe_data); if (ret == 0) { add_to_sqlite_database(ws, cpe_data); cpe_to_string(buffer, BUFFERSIZE, cpe_data); fprintf(stdout, &amp;quot; - Found match for %s/%s:\t%s\n&amp;quot;, ws-&amp;gt;currentdir, ws-&amp;gt;currentfile, buffer); }; } else { fprintf(stderr, &amp;quot; !</description></item><item><title>[zz]FBI被指在OpenBSD的IPSEC协议栈中放置后门</title><link>/posts/zz_fbi_accused_of_placing_a_backdoor_in_openbsd39s_ipsec_stack/</link><pubDate>Thu, 08 Nov 2012 02:20:00 +0000</pubDate><guid>/posts/zz_fbi_accused_of_placing_a_backdoor_in_openbsd39s_ipsec_stack/</guid><description>FBI被指在OpenBSD的IPSEC协议栈中放置后门ugmbbc发布于 2010-12-16 07:56:21|7520 次阅读 OpenBSD创始人Theo de Raadt公开了Gregory Perry的一封来信。Gregory Perry在10年前参与了OpenBSD加密框架开发。在信函中，他声称FBI付费给开发商，以在OpenBSD的IPSEC协议栈中植入后门。 现在他将这段机密公诸于众，是因为他与FBI签署的保密协议已到期。10年前加入的后门代码如今已经面目全非，de Raadt表示不清楚代码造成的真正影响有多大，由于OpenBSD是第一个开发出供免费使用的IPSEC协议栈，因此随后许多项目和产品都是直接拿现成 的代码。 查看:Subject: Allegations regarding OpenBSD IPSECList: openbsd-techSubject: Allegations regarding OpenBSD IPSECFrom: Theo de Raadt &amp;lt;deraadt () cvs ! openbsd ! org&amp;gt;Date: 2010-12-14 22:24:39Message-ID: 201012142224.oBEMOdWM031222 () cvs ! openbsd ! org[Download message RAW]I have received a mail regarding the early development of the OpenBSDIPSEC stack. It is alleged that some ex-developers (and the companythey worked for) accepted US government money to put backdoors intoour network stack, in particular the IPSEC stack.</description></item><item><title>【转】京东修复充值平台漏洞否认亏损2亿 有网友借机充36万2</title><link>/posts/switch_jingdong_repair_recharge_platform_vulnerabilities_have_denied_losses_200_000_000_360_002_netizens_took_the_opportunity_to_charge/</link><pubDate>Thu, 01 Nov 2012 05:34:00 +0000</pubDate><guid>/posts/switch_jingdong_repair_recharge_platform_vulnerabilities_have_denied_losses_200_000_000_360_002_netizens_took_the_opportunity_to_charge/</guid><description>京东修复充值平台漏洞否认亏损2亿 有网友借机充36万2012年11月01日 02:58来源：每日经济新闻 作者：席大伟分享到： 更多 890人参与45条评论昨日(10月31日)上午，据微博网友爆料，京东商城充值平台10月30日22：30左右出现了一个多小时漏洞，不少用户利用该漏洞套取话费和Q币，有用户甚至借机充值金额高达36万元。对此，京东商城相关人士表示，此次系充值平台出现漏洞，目前已经修复，对借机充值行为，京东法律相关部门已经介入。而对于有消息称“京东此次亏损高达2亿元”，京东方面给予否认。IT法律专家赵占领昨日在接受《每日经济新闻》记者采访时表示，如果是在不知情的情况下，充值成功，则构成不当得利，网站可以以重大误解为由要求解除合同。但如果是知情仍恶意下订单，数额达到一定标准，涉嫌构成盗窃犯罪。有网友借机充值36万昨日，不少新浪用户在微博上爆料，称10月30日22：30开始，京东商城充值平台出现了BUG(漏洞)：点击充值按钮后，系统会自动充值，但不会扣掉相应积分。若充值成功，积分还会双倍返还回账户。同时，由于京东该平台宣称“1-10分钟到账”，在10月30日晚间甚至达到10秒钟就能充值完成，不少发现此漏洞的网友在QQ群里传播该漏洞信息，随后在互联网上快速扩散，不少网友也参与进来。据网友透露，有很大一部分用户都充了上千元的Q币和话费，甚至还有用户借机充了36万元的话费。据估计，此次漏洞给京东带来了将近2亿元的损失。当晚23点40分，京东商城就已及时修补漏洞并且报警。一些网友大呼“遗憾”，并在京东商城官方微博留言，声称“可惜没赶上这么大的漏洞”。据《每日经济新闻》记者了解，京东这一充值平台是前日刚上线的新功能，正处于测试期。京东称损失2亿属谣言京东商城相关负责人表示,有关京东商城积分无限制充值话费点卡，经核查，系京东商城上线积分换购新业务时出现的系统BUG所致，但亏损2亿元纯属谣传。目前，内部正在处理此事，技术部分已经修复，法务也开始介入此事，并同时报案。这并非京东平台第一次出现漏洞。不久前就有不少用户反映，账号被盗余额被消费，京东一直强调这是由于此前CSDN网站数据招黑客攻击泄露所引发的后遗症。昨日，记者登录京东商城充值平台，发现已经可以正常使用积分换购相关商品，也可以进行正常的手机话费、Q币等充值。这看起来应该是京东为技术疏忽而承担损失，但从法律角度来看，一些在此期间趁机大规模套现的用户行为则已经涉嫌犯罪。对此，北京盛峰律师事务所主任律师于国富昨日对《每日经济新闻》记者表示，虽然京东系统出现漏洞，其本身确实存在过失，但如果有用户恶意大量套现，性质依然属于“盗窃”行为。据于国富介绍，如果用户当时充值时并不知道漏洞存在，只是进行正常充值，随后发现没有被扣款，这种情况属于不当得利，应当予以返还，只是在民事上的交易行为，并不会构成犯罪。京东商城方面也表示，其后期将与相关用户协商解决此次问题，对于一些恶意订单用户，京东商城将保留进一步追究其法律责任的权利。</description></item><item><title>[转]Mozilla面向旧版火狐发布安全更新 安全公司警告火狐3.6存新安全漏洞</title><link>/posts/rpm_mozilla_firefox_released_security_updates_for_earlier_versions_of_the_security_company_warned_firefox_36_new_security_vulnerabilities_exist/</link><pubDate>Mon, 29 Oct 2012 07:17:00 +0000</pubDate><guid>/posts/rpm_mozilla_firefox_released_security_updates_for_earlier_versions_of_the_security_company_warned_firefox_36_new_security_vulnerabilities_exist/</guid><description>Mozilla面向旧版火狐发布安全更新 安全公司警告火狐3.6存新安全漏洞dryiceboy发布于 2010-02-20 07:58:27|3046 次阅读 Mozilla公司近日面向旧版本火狐浏览器推出了五款安全更新补丁，而另外一家安全公司Secunia则警告用户称最新版火狐3.6中可能存在一个危险 程度极高的安全漏洞。今年一月份，Mozilla公司曾扬言称不会再对火狐3.0等老版本浏览器提供技术支持，不过本周三，Mozilla公司还是为火狐浏览器的3.5.8，以及3.0.18等版本的旧款浏览器发布了数款更新补丁，并表示旧版版本中有关的漏洞在1月21日发布的最新版火狐3.6浏览器中已经被修正。这次的更新主要面向五个旧版浏览器的安全漏洞，其中有三个漏洞被Mozilla公司标记为“危急”级别。造成这三个漏洞的主要原因有：1、浏览器处理内存不足的过程中出错；2、Gecko网页渲染引擎存在不稳定问题；3、专门处理脚本文件的Web worker部分无法正常处理已张贴的信息。Mozilla表示，以上三个漏洞均可被恶意软件利用来入侵用户的系统。而余下的两个漏洞的危害级别则稍低，可允许攻击者执行恶意 JavaScript代码。这次面向火狐3.5.8和3.0.18版本的安全更新可适用于Windows，Mac OSX和Linux三种操作系统，用户可以通过浏览器内建的升级功能来安装这些安全更新。另外，Secunia安全公司本周四报道称他们发现了火狐3.6版本中的一个新的安全漏洞，Mozilla公司目前为止仍未就该安全漏洞发布修正补丁，Secunia警告称此漏洞可令攻击者在用户的系统中执行恶意代码。据Secunia称，目前安装了VulnDisco Pack插件的Immunity公司Canvas漏洞测试软件可以检测出这一漏洞，不过VulnDisco Pack的开发公司 Intevydis并没有将该漏洞的细节公开，Secunia公司将这一漏洞标记为“高危”级别。</description></item></channel></rss>